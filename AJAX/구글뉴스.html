<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>구글 뉴스</title>
</head>
<body>
    검색어 <input id="id_sch" type=text value=""> <input id="id_google" type=button value="검색">
    <div id="id_disp"></div>
<script>
    // open api 사용할 땐 먼저 아작스로 바로 요청을 받을 수 있는지 확인
    var v_disp = document.getElementById("id_disp");
    var v_chWord = document.querySelector("#id_sch");
    document.querySelector("#id_google").onclick = function() {
        var v_ajax = new XMLHttpRequest();
        v_ajax.open("get","quakquak.php?cat="+ v_chWord.value,true); // php 가 서버를 우회하여 보여주는 중계자 역할
        v_ajax.onreadystatechange = function() {
            if(v_ajax.readyState == 4 && v_ajax.status == 200) {
                // alert(v_ajax.responseText);
                console.log(JSON.parse(v_ajax.responseText).channel.item);   // 검색내용 기본 100개
                /*
                    검색된 내용이 id_disp에 table 형식으로 나오도록 
                    순번 제목 (링크 걸기) 소스 
                */
               var v_newsItems = JSON.parse(v_ajax.responseText).channel.item;

               var str = "<table border=1>" ;
                str += "<tr><td>순번</td><td>제목</td><td>출처</td></tr>" ;
                for(var i = 0; i < v_newsItems.length; i++) {
                    str += "<tr>";
                    str += "<td>" + (i+1) + "</td>";
                    str += "<td><a target=blank href='"+ v_newsItems[i].link +"'>" + v_newsItems[i].title + "</a></td>";
                    str += "<td>" + v_newsItems[i].source + "</td>";
                    str += "</tr>";
                }
                str += "</table>";
                v_disp.innerHTML = str;
            }
        }
        v_ajax.send();
    }
</script>
</body>
</html>